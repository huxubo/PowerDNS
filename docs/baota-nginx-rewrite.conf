# 宝塔面板 Nginx 伪静态规则
# PowerDNS API 专用配置
#
# 使用方法：
# 1. 在宝塔面板中，进入网站设置
# 2. 点击"伪静态"选项卡
# 3. 复制下面的规则粘贴到配置框中
# 4. 点击"保存"

location / {
    try_files $uri $uri/ /index.php?$query_string;
}

location ~ \.php$ {
    fastcgi_pass unix:/tmp/php-cgi.sock;
    fastcgi_index index.php;
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    include fastcgi_params;
}

# 禁止访问隐藏文件
location ~ /\. {
    deny all;
    access_log off;
    log_not_found off;
}

# 禁止访问配置文件目录
location ~ /config/ {
    deny all;
    access_log off;
    log_not_found off;
}

# 禁止访问数据库文件
location ~ /database/ {
    deny all;
    access_log off;
    log_not_found off;
}

# 禁止访问源代码目录（src）
location ~ /src/ {
    deny all;
    access_log off;
    log_not_found off;
}

# 注意：
# - 如果使用 PHP 7.4，fastcgi_pass 可能是: unix:/tmp/php-cgi-74.sock
# - 如果使用 PHP 8.0，fastcgi_pass 可能是: unix:/tmp/php-cgi-80.sock
# - 如果使用 PHP 8.1，fastcgi_pass 可能是: unix:/tmp/php-cgi-81.sock
# 
# 可以在"软件商店" → "PHP" → "设置" → "配置文件"中查看实际的 sock 文件路径
